/* === No Drowsy!! — 모바일 고정 레이아웃 (덮어쓰기용) === */

/* 색상 변수 */
:root{
  --bg-dark-1: #071018;
  --bg-dark-2: #0f1b22;
  --accent: #dfeffb;
  --muted: rgba(255,255,255,0.22);
  --glass-border: rgba(255,255,255,0.04);
}

/* reset */
*{box-sizing:border-box; margin:0; padding:0;}
html,body{height:100%; font-family:"Inter","Noto Sans KR",system-ui,-apple-system,"Segoe UI",Roboto,Arial; -webkit-font-smoothing:antialiased;}
body{
  background: #0a0a0a; /* 페이지 배경 (브라우저 영역) */
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}

/* === device viewport: 스마트폰 비율 고정 ===
   기본: 390 x 844 (iPhone-ish). 화면 작을땐 max-width:92vw로 축소 */
#device, .device-viewport {
  width: 390px;
  height: 844px;
  max-width: 92vw;
  max-height: 96vh;
  position: relative;
  border-radius: 28px;
  overflow: hidden;
  box-shadow: 0 18px 40px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
  background: linear-gradient(180deg, var(--bg-dark-1) 0%, var(--bg-dark-2) 100%);
  -webkit-font-smoothing:antialiased;
}

/* stage area*/
#stageArea, .stage-area {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: calc(100%);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 12px;
  gap: 8px;
  text-align: center;
  z-index: 10;
}

/* stage text */
#stageLabel, .stage-label {
  font-size: 55px;
  font-weight: 800;
  color: var(--accent);
  letter-spacing: 0px;
  white-space: pre-line;   /* \n을 줄바꿈으로 해석 */
  text-align: center;
  line-height: 1.2;
  transform: translateY(-100px); /* 글자를 위로 100px 이동 */
}
#dValue, .d-value {
  font-size: 20px;
  font-weight: 700;
  color: #ffffff;
  margin-top: 6px;
}
#centerMessage, .center-message {
    font-size: 30px;
  display: none;
  margin-top: 12px;
  font-weight: 800;
  padding: 12px 16px;
  border-radius: 12px;
  background: rgba(255,255,255,0.04);
  color: #fff;
  white-space: pre-line; /* \n을 줄바꿈으로 해석 */
  text-align: center;
}

/* === chat overlay: 화면 하단 30%, 완전 투명 배경 === */
#chatOverlay, .chat-overlay {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 30%;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 12px;
  gap: 8px;
  z-index: 40;
  background: transparent;
  pointer-events: auto;
}

/* 채팅 로그: 투명, 스크롤 가능 */
#chatLog, .chat-log {
  flex: 1 1 auto;
  width: 100%;
  overflow-y: auto;
  display:flex;
  flex-direction:column;
  gap:8px;
  padding-right:6px;
  background: transparent; /* 투명 유지 */
}

/* 말풍선: 배경은 투명(텍스트만 보이게) */
.bubble {
  max-width: 82%;
  padding: 6px 10px;
  border-radius: 12px;
  background: transparent; /* 투명 배경 */
  color: var(--accent);
  font-size: 14px;
  line-height: 1.2;
  word-break:break-word;
  box-shadow: none;
  border: none;
}
.bubble.user { align-self: flex-end; text-align: right; color: #cfe9ff; }
.bubble.assistant { align-self: flex-start; text-align: left; color: #ffffff; }

/* 채팅 입력 컨트롤: 입력필드만 약간 반투명 (가독성 유지) */
.chat-controls {
  display:flex;
  gap:8px;
  align-items:center;
  width:100%;
  height:52px;
  padding:6px;
  border-radius:10px;
  background: transparent; /* overlay 배경은 투명, 내부도 투명 유지 */
}
#chatInput {
  flex:1;
  height:100%;
  padding:10px 12px;
  border-radius:10px;
  background: rgba(255,255,255,0.03); /* 입력창만 약간 반투명 */
  border: 1px solid var(--glass-border);
  color: var(--accent);
  font-size:15px;
  outline:none;
}
#chatInput::placeholder { color: var(--muted); }

/* 버튼 스타일 (필요시 사용) */
.btn {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:44px;
  height:44px;
  border-radius:8px;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.03);
  color:var(--accent);
  cursor:pointer;
}

/* stage area background variants (상태별 배경) */
/* 정상 */.bg-normal { background: linear-gradient(90deg, #167af5, #98f5f5);}
/* 의심경고 */.bg-attention {  background: linear-gradient(90deg, #fa6502 100%, #f7923f 100%);}
/* 집중모니터링 */.bg-focused { background: linear-gradient(180deg, #37c3e6 0%, #061b22 100%);}

/* 개선 */.bg-improving { background: linear-gradient(90deg, #98f5f5, #167af5);}


.bg-L1 { background: radial-gradient(circle at center, #1b1b1a 30%, #000000 90%);
  animation: failPulse 2.5s ease-in-out infinite;
  will-change: filter;
}
@keyframes L1 {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(1.5); } /* 최고 밝기 */
  100% { filter: brightness(1); }
}
.bg-L2 { background: radial-gradient(circle at center, #074901 30%, #000000 90%);
  animation: failPulse 2.0s ease-in-out infinite;
  will-change: filter;
}
@keyframes L2 {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(1.5); } /* 최고 밝기 */
  100% { filter: brightness(1); }
}
.bg-L3 { background: radial-gradient(circle at center, #a201ff 30%, #000000 90%);
  animation: failPulse 1.5s ease-in-out infinite;
  will-change: filter;
}
@keyframes L3 {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(1.5); } /* 최고 밝기 */
  100% { filter: brightness(1); }
}
.bg-FAILSAFE {
  background: radial-gradient(circle at center, #ff0101 30%, #000000 90%);
  animation: failPulse 0.5s ease-in-out infinite;
  will-change: filter;
}
@keyframes failPulse {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(1.5); } /* 최고 밝기 */
  100% { filter: brightness(1); }
}


/* center-active effect (when showing centerMessage) */
.stage-area.center-active #centerMessage,
#stageArea.center-active #centerMessage {
  display:block;
  animation: popIn 220ms ease-out;
}
@keyframes popIn {
  from { transform: translateY(-6px) scale(0.98); opacity: 0; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}

/* 반응형: 아주 작은 화면에서 텍스트 줄임 */
@media (max-width:420px) {
  #stageLabel, .stage-label { font-size: 28px; }
  #dValue, .d-value { font-size: 16px; }
  #chatInput { font-size: 14px; }
}

/* 접근성/포커스 */
#chatInput:focus, .btn:focus {
  box-shadow: 0 0 0 4px rgba(100,160,255,0.04);
  border-color: rgba(100,160,255,0.12);
  outline:none;
}


/* 기본 announcement 스타일 (스마트폰 비율 기준) */
.announcement {
  font-size: 6vw;        /* 화면 너비에 따라 크기 자동 조정 */
  line-height: 1.1;
  color: #ffffff;        /* 기본 글자색 (하얀색) */
  text-align: center;    /* 가운데 정렬 */
  font-weight: 700;
  padding: 1vh 2vw;
  background: transparent; /* 배경 투명 */
  -webkit-font-smoothing: antialiased;
  word-break: keep-all;
}

/* 채팅 말풍선 */
.chat-bubble {
  font-size: 4vw;
  padding: 10px 14px;
  border-radius: 12px;
  margin: 6px 0;
  max-width: 80%;
  background: rgba(255,255,255,0.06); /* 반투명 말풍선 */
}

/* 어시스턴트(LLM) 말풍선 */
.chat-bubble.assistant {
  align-self: flex-start;
  color: #fff;
}

/* 유저 말풍선 */

.chat-bubble.user {
  align-self: flex-end;
  color: #000;
  background: rgba(255,255,255,0.9);
}
